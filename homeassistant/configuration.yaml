homeassistant:
  # Name of the location where Home Assistant is running
  name: Williamson Ave
  # Location required to calculate the time the sun rises and sets
  latitude: -36.8594849
  longitude: 174.7467815
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 16
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Pacific/Auckland
  # Customization file
  customize: !include customize.yaml

# Show links to resources in log and frontend
#introduction:

# Enables the frontend
frontend:

# Enables configuration UI
config:

http:
  # Secrets are defined in the file secrets.yaml
  api_password: !secret http_password
  # Uncomment this if you are using SSL/TLS, running in Docker container, etc.
  base_url: williamson-ave.duckdns.org
  trusted_networks:
#    - 127.0.0.1
#    - ::1
#    - 192.168.1.0/24

# Checks for available updates
# Note: This component will send some information about your system to
# the developers to assist with development of Home Assistant.
# For more information, please see:
# https://home-assistant.io/blog/2016/10/25/explaining-the-updater/
updater:
  # Optional, allows Home Assistant developers to focus on popular components.
  # include_used_components: true

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time
history:

# View all events in a logbook
logbook:

# Enables a map showing the location of tracked devices
map:

# Track the sun
sun:

# Covers
cover:
# Open Garage
  platform: opengarage
  covers:
    garage:
      host: 192.168.1.130
      device_key: !secret opengarage_devicekey
      name: Garage door

# Sensors      
sensor:
# Weather prediction
  - platform: openweathermap
    api_key: !secret owm_api_key
    forecast: true
    monitored_conditions:
      - weather
      - temperature
      - wind_speed
      - rain
# Garage Door
  - platform: template
    sensors:
      garage_status:
        friendly_name: Garage door status
        value_template: >-
          {% if states.cover.garage_door %}
            {% if states.cover.garage_door.attributes["door_state"] == "open" %}
              Open
            {% elif states.cover.garage_door.attributes["door_state"] == "closed" %}
              Closed
            {% elif states.cover.garage_door.attributes["door_state"] == "opening" %}
              Opening
            {% elif states.cover.garage_door.attributes["door_state"] == "closing" %}
              Closing
            {% else %}
              Unknown
            {% endif %}
          {% else %}
            N/A
          {% endif %}

      garage_car_present:
        friendly_name: Car in Garage
        value_template: >-
          {% if states.cover.garage_door %}
            {% if states.cover.garage_door.state == "open" %}
              N/A
            {% elif ((states.cover.garage_door.attributes["distance_sensor"] > 50) and (states.cover.garage_door.attributes["distance_sensor"] < 150)) %}
              Yes
            {% else %}
              No
            {% endif %}
          {% else %}
            N/A
          {% endif %}  

binary_sensor:
# External connectivity
  - platform: ping
    host: google.com
    name: Internet connection
# Presence detection
 - platform: template
    sensors:
      home_occupied:
        friendly_name: Home occupied
        value_template: >-
          {{ is_state('group.all_devices', 'home') }}   

weather:
  - platform: openweathermap
    api_key: !secret owm_api_key

# Text to speech
tts:
  - platform: google

# Cloud
cloud:

# Device tracking
device_tracker:
 - platform: nmap_tracker
   hosts: 192.168.1.1/24
   interval_seconds: 60
   new_device_defaults:
      track_new_devices: false
 - platform: unifi
   host: media-hub
   username: !secret unifi_user
   password: !secret unifi_password
   verify_ssl: false
   ssid_filter:
    - 'Unit13-Guests'
   new_device_defaults:
    track_new_devices: true
    hide_if_away: true
   

# Notifications
notify:
 - name: pushbullet
   platform: pushbullet
   api_key: !secret pushbullet_api_key
 - name: html5
   platform: html5
   gcm_api_key: !secret gcm_server_key
   gcm_sender_id: !secret gcm_sender_id

   # IFTT automation
ifttt:
  key: !secret ifttt_key
  
# Z Wave configuration
zwave:
  usb_path: /dev/ttyACM0
  new_entity_ids: true

# Wink to enable August smartlock integration
august:
  login_method: email
  username: !secret august_username
  password: !secret august_password

# Konnected Smart alarm
# konnected:
#   auth_token: !secret konnected_token
#   devices:
#     - id: 18fe34e88a5F
#       actuators:
#         - pin: 5
#           name: 'Siren'
#           activation: low
#       sensors:
#         - pin: 1
#           type: motion
#           name: 'Entrance'
#         - pin: 2
#           type: motion
#           name: 'Guest bedroom'
#         - pin: 3
#           type: motion
#           name: 'Living room'

# Alarm control panel
alarm_control_panel:
  - platform: manual
    name: Alarm
    code: !secret alarm_code
    pending_time: 30 # secs to leave after arm
    delay_time: 30 # secs to disarm 

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
zone: !include zones.yaml